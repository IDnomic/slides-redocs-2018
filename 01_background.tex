\section[PKI and blockchains]{Background on public key infrastructure (PKI) and blockchains}


\begin{frame}{Public-key encryption}
\begin{center}
\begin{tikzpicture}
[node distance=2cm and 0.5cm]
% 'd' for dummies
% upper level: r  sk  d pk d5
% lower level: d2 d3 ct d4 pt s

% lower
\node[label=above:{Recipient}](r) {{\LARGE \faUser}};

\node[right = of r.east] (d3) {decrypt};

\node[right = of d3.east, label=below:{ciphertext}] (ct) {{\Huge \faFileText}};

\node[right = of ct.east] (d4) {encrypt};

\node[right = of d4.east, label=below:{plaintext}] (pt) {{\Huge \faFileTextO}};

\node[right = of pt.east, label=above:{Sender}](s) {{\LARGE \faUser}};

% upper

\node[above = of d3.north, label=above: {secret key}] (sk) {{\Huge \red{\faKey}}};

\node[above = of d4.north, label=above: {public key}] (pk) {{\Huge \olive{\faKey}}};


%\node[](r) {Recipient:};
%
%\node[right = of r.east, label=above: {secret key}] (sk) {{\Huge \red{\faKey}}};
%
%\node[right = of sk.east] (d) {};
%
%\node[right = of d.east, label=above: {public key}] (pk) {{\Huge \olive{\faKey}}};
%
%\node[right = of pk.east] (d5) {};

%horizontal upper
%\draw[->] (r) to (sk);

%vertical
\draw[->] (pk) to (d4);
\draw[->] (sk) to (d3);
%\draw[->] (d2) to (r);

%horizontal lower
\draw[-] (s) to (pt);
\draw[-] (pt) to (d4);
\draw[->] (d4) to (ct);
\draw[-] (ct) to (d3);
\draw[->] (d3) to (r);

\end{tikzpicture}
\end{center}

%{\large test test}
%
%{\LARGE test test}
%
%{\LARGE \faKey}
\end{frame}

\begin{frame}{Public key infrastructure}

\begin{itemize}
\item \mg{Public key infrastructure (PKI)}: a set of roles, policies, and procedures needed to
%create, manage, distribute, use, store, and revoke
%digital certificates and manage public-key encryption.
ensure
secure distribution of public keys
\item Based on digital certificates
\end{itemize}


%'digital certificate = signature
%binding an entity to some public key'

%\vspace{2mm}
%
%PKI involves
%\begin{itemize}
%\item public key cryptography,
%\item digital certificates,
%\item digital identity management.
%\end{itemize}

\end{frame}


\begin{frame}{Digital certificate}
%based on https://tex.stackexchange.com/a/8935
\begin{center}
\begin{tikzpicture}[mymatrix/.style={matrix of nodes, nodes=typetag, row sep=1em},
  mycontainer/.style={draw=gray, inner sep=1ex},
  typetag/.style={draw=gray, inner sep=1ex, anchor=west},
  title/.style={draw=none, color=gray, inner sep=0pt}
  ]
  \matrix[mymatrix] (user) {
    |[title]|Entity's data (ED)\\
    unique identifier\\
    public key $\mathtt{pk}_{\mathtt{E}}$ \\
    ... \\
  };
  
  \node[right=of user.east] (fake) {};
  
  \node[above = of fake] (fakeN) {$\mathtt{sk}_{\mathtt{CA}}$};
  
  \node[draw,rectangle,
fill=white, above = of fakeN](ca) {Certificate authority (CA)};
  
    \matrix[mymatrix, right=of fake.east, matrix anchor=west] (cert) {
    |[title]|Digital certificate\\
    CA's identifier\\
    $\mathtt{Sign}_{\mathtt{sk}_{\mathtt{CA}}}($ED$)$\\
    ...\\
  };
  
  \node[mycontainer, fit=(user)] {};
  \node[mycontainer, fit=(cert)] {};
  \draw [->] (user) to (cert);
  \draw [-] (ca) to (fakeN);
  \draw [->] (fakeN) to (fake);
  
\end{tikzpicture}
\end{center}
\pause
\begin{center}
CA certifies: $\mathtt{pk}_{\mathtt{E}}$
is indeed the public key of the entity
\end{center}
\end{frame}


\begin{frame}{Chain of trust}

%\begin{tikzpicture}
%\node[\draw  (-6,6) rectangle (-2,2)] {no elo};
%\draw (-6,5) -- (-2,5) -- (-2,4) -- (-6,4) -- (-6,3) -- (-2,3);
%\node at (-5.5,5.5) {};
%\end{tikzpicture}
heh

\end{frame}

\begin{frame}

revocation of certificates

\end{frame}


\begin{frame}{Blockchain definition}

\begin{itemize}
\item \mg{Blockchain}: a public, transparent,
append-only ledger
%\pause
\item Created by members of a peer-to-peer
network
\item Immutable and unforgeable records (\mg{blocks})
%Records \mg{blocks} stored in the ledger are immutable
%and unforgeable
\item FunFactHere?
\end{itemize}

\end{frame}



\begin{frame}{Blockchain structure}

\begin{itemize}
\item \mg{Transaction}: atomic event
allowed by the blockchain protocol (`Alice sends Bob $0.1$ BTC')
\item Transactions are \mg{validated} and \mg{broadcast}
throughout the network.
\item Validated transactions
stored in \mg{blocks}
\item Blocks linked together,
forming a \mg{chain}
\item The choice of the next blocks to be
added to the chain is a result of a \mg{consensus
process}
\end{itemize}

\end{frame}

\begin{frame}{Blockchain structure}

\begin{center}
\begin{tikzpicture}[mymatrix/.style={matrix of nodes, nodes=typetag, row sep=1em},
  mycontainer/.style={draw=gray, inner sep=1ex},
  typetag/.style={draw=gray, inner sep=1ex, anchor=west},
  title/.style={draw=none, color=gray, inner sep=0pt}
  ]
  \matrix[mymatrix] (block) {
    |[title]|Block\\
    hash of the last block\\
    creator's of the block (\mg{miner}) ID\\
    set of transactions\\
    ...\\
  };
  
  
  \node[mycontainer, fit=(block)] {};
  
\end{tikzpicture}
\end{center}

\end{frame}


\begin{frame}{Blockchain structure}

\begin{center}
\begin{tikzpicture}

  \node[draw,rectangle,
fill=white, label=below:{Genesis block}](gb) {Block 0};

  \node[draw,rectangle,
fill=white, right = of gb](b1) {Block 1};

  \node[right = of block.east, label=below:{...}] (dots) {};
  
    \node[draw,rectangle,
fill=white, right = of dots](bl) {Block $n$};

  \node[right = of bl.east] (dummy) {};
  
%  \node[above = of dummy.north] (dummy2) {};
%  
%  \node[below = of dummy.north] (dummy3) {};
  
%   \node[draw,rectangle,
%fill=white, right = of dummy2](nb1) {Block?};
%
%   \node[draw,rectangle,
%fill=white, right = of dummy3](nb2) {Block???};

   \node[draw,rectangle,
fill=white, right = of bl.north east](nb1) {Block?};

   \node[draw,rectangle,
fill=white, right = of bl.south east](nb2) {Block???};
  
  
  \draw [->] (gb) to (b1);
  \draw [->] (b1) to (dots);
  \draw [->] (dots) to (bl);
  \draw [->] (bl) to (nb1);
  \draw [->] (bl) to (nb2);
  
\end{tikzpicture}
\end{center}

ugly, to be modified

\end{frame}